---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
In this section of the analysis we check whether the input data file `activity.csv` is in the *R Working Directory*, and download the zip version if necessary. Then we unzip the downloaded file. Before the download, we determine whether the code is running on a Windows-based operating system and specify the correct method (curl or wininet). 
```{r}

if(!file.exists("activity.csv")){
     dlMethod <- "curl"
     if(substr(Sys.getenv("OS"),1,7) == "Windows") dlMethod <- "wininet"
     url <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
     download.file(url,destfile='activity.zip',method=dlMethod,mode="wb")
     unzip(zipfile = "activity.zip")    
}

```
For reading the file, we prefer Hadley Wickham's `readr` package, which runs orders of magnitude faster than read routines in Base R. The data is comma separated, so we'll use `read_csv` to load the activity data.  

```{r}
library(readr)
activityData <- read_csv("activity.csv",
     col_types=list(col_double(),col_character(),col_double()))

```
The unit of analysis or "observation" in the input file is a the number of steps taken in a five minute interval. Therefore, each day includes 288 individual observations. To analyze the data by day, we'll need to aggregate the number of steps by day. The `aggregate()` function ignores missing values by default, so the output data frame will have no missing values for the `steps` column. 

```{r}
dailySteps <- aggregate(steps ~ date,FUN=sum,data=activityData)
```
Since some of our analysis will be easier to read if we understand the hour of the day, we will convert the five minute intervals into a time vector. 
```{r}
activityData <- within(activityData,{
     hour <- trunc(interval / 60)
     minute <- interval - (hour * 60)
     theTime <- as.POSIXlt(sprintf("%02d:%02d:00",hour,minute),tz="","%H:%M:%S")
})
```


## What is mean total number of steps taken per day?

One way to look at the distribution of steps data is to generate a histogram. We will adjust the default of 5 break points to 8 so we can obtain a more detailed picture of the variability between 10,000 and 15,000 steps per day than is generated by the default histogram. 

```{r}
hist(dailySteps$steps,
     main="Histogram of Daily Steps",
     xlab="Total Daily Steps",
     breaks = 8)
```

The mean and median numbers of steps per day included in the following `summary()` output. 
```{r}
summary(dailySteps$steps)
```

## What is the average daily activity pattern?
The daily activity pattern illustrates the number of steps per five minute period, aggregated across all days. First, we'll aggregate the steps data to the average steps per five minute period, across all days. Then we'll display the result in an X / Y plot. 

```{r}
dailyPattern <- aggregate(steps ~ interval,FUN=mean,data = activityData)
plot(dailyPattern$interval,dailyPattern$steps,
     type="l",
     main="Average Steps per 5 Minute Interval",
     xlab="Interval (5 minutes)",
     ylab="Mean(steps)")
```

Next, we'll find the five minute interval with the maximum number of steps on average.
```{r}
dailyPattern[dailyPattern$steps == max(dailyPattern$steps),] 
```

## Imputing missing values

The total number of missing values in the data set is 2,304. 

```{r}
sum(is.na(activityData$steps))
```

Multiple approaches may be taken to substitute missing values with a valid value, ranging from the daily mean steps, or the interval mean steps. Since there are 288 observations in the dailyPattern data frame, we know we have valid observations for each interval in the day. Also, since the number of steps on average does vary by interval, the average per interval is probably a more appropriate missing value substitution strategy than taking the average for each day. 

We will merge the the `dailyPattern` data frame with the `activityData` frame by interval, after renaming the `steps` column in `dailySteps` to `avgSteps`. 

```{r}

```

## Are there differences in activity patterns between weekdays and weekends?
